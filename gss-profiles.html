<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en"><head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/"><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>Simplified and Minimized Profiles of the Generic Security Services Application Programming Interface</title><style type="text/css" title="Xml2Rfc (sans serif)">
a {
  text-decoration: none;
}
a.smpl {
  color: black;
}
a:hover {
  text-decoration: underline;
}
a:active {
  text-decoration: underline;
}
address {
  margin-top: 1em;
  margin-left: 2em;
  font-style: normal;
}
body {
  color: black;
  font-family: verdana, helvetica, arial, sans-serif;
  font-size: 10pt;
  margin-right: 2em;
}
cite {
  font-style: normal;
}
dl {
  margin-left: 2em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}
dl p {
  margin-left: 0em;
}
dt {
  margin-top: .5em;
}
h1 {
  font-size: 14pt;
  line-height: 21pt;
  page-break-after: avoid;
}
h1.np {
  page-break-before: always;
}
h1 a {
  color: #333333;
}
h2 {
  font-size: 12pt;
  line-height: 15pt;
  page-break-after: avoid;
}
h3, h4, h5, h6 {
  font-size: 10pt;
  page-break-after: avoid;
}
h2 a, h3 a, h4 a, h5 a, h6 a {
  color: black;
}
img {
  margin-left: 3em;
}
li {
  margin-left: 2em;
}
ol {
  margin-left: 2em;
}
ol.la {
  list-style-type: lower-alpha;
}
ol.ua {
  list-style-type: upper-alpha;
}
ol p {
  margin-left: 0em;
}
p {
  margin-left: 2em;
}
pre {
  margin-left: 3em;
  background-color: lightyellow;
  padding: .25em;
  page-break-inside: avoid;
}
pre.text2 {
  border-style: dotted;
  border-width: 1px;
  background-color: #f0f0f0;
  width: 69em;
}
pre.inline {
  background-color: white;
  padding: 0em;
}
pre.text {
  border-style: dotted;
  border-width: 1px;
  background-color: #f8f8f8;
  width: 69em;
}
pre.drawing {
  border-style: solid;
  border-width: 1px;
  background-color: #f8f8f8;
  padding: 2em;
}
table {
  margin-left: 2em;
}
table.header {
  border-spacing: 1px;
  width: 95%;
  font-size: 10pt;
  color: white;
}
td.top {
  vertical-align: top;
}
td.topnowrap {
  vertical-align: top;
  white-space: nowrap; 
}
table.header td {
  background-color: gray;
  width: 50%;
}
table.header a {
  color: white;
}
td.reference {
  vertical-align: top;
  white-space: nowrap;
  padding-right: 1em;
}
thead {
  display:table-header-group;
}
ul.toc, ul.toc ul {
  list-style: none;
  margin-left: 1.5em;
  padding-left: 0em;
}
ul.toc li {
  line-height: 150%;
  font-weight: bold;
  font-size: 10pt;
  margin-left: 0em;
}
ul.toc li li {
  line-height: normal;
  font-weight: normal;
  font-size: 9pt;
  margin-left: 0em;
}
li.excluded {
  font-size: 0pt;
}
ul p {
  margin-left: 0em;
}

.comment {
  background-color: yellow;
}
.center {
  text-align: center;
}
.error {
  color: red;
  font-style: italic;
  font-weight: bold;
}
.figure {
  font-weight: bold;
  text-align: center;
  font-size: 9pt;
}
.filename {
  color: #333333;
  font-weight: bold;
  font-size: 12pt;
  line-height: 21pt;
  text-align: center;
}
.fn {
  font-weight: bold;
}
.hidden {
  display: none;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.title {
  color: #990000;
  font-size: 18pt;
  line-height: 18pt;
  font-weight: bold;
  text-align: center;
  margin-top: 36pt;
}
.vcardline {
  display: block;
}
.warning {
  font-size: 14pt;
  background-color: yellow;
}


@media print {
  .noprint {
    display: none;
  }
  
  a {
    color: black;
    text-decoration: none;
  }

  table.header {
    width: 90%;
  }

  td.header {
    width: 50%;
    color: black;
    background-color: white;
    vertical-align: top;
    font-size: 12pt;
  }

  ul.toc a::after {
    content: leader('.') target-counter(attr(href), page);
  }
  
  ul.ind li li a {
    content: target-counter(attr(href), page);
  }
  
  .print2col {
    column-count: 2;
    -moz-column-count: 2;
    column-fill: auto;
  }
}

@page {
  @top-left {
       content: "Internet-Draft"; 
  } 
  @top-right {
       content: "December 2012"; 
  } 
  @top-center {
       content: "GSS-API Profiles"; 
  } 
  @bottom-left {
       content: "Williams"; 
  } 
  @bottom-center {
       content: "Expires June 17, 2013"; 
  } 
  @bottom-right {
       content: "[Page " counter(page) "]"; 
  } 
}

@page:first { 
    @top-left {
      content: normal;
    }
    @top-right {
      content: normal;
    }
    @top-center {
      content: normal;
    }
}
</style><link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Simple Profiles of the GSS-API" href="#rfc.section.2"><link rel="Chapter" title="3 Transport Security Layer Profiles" href="#rfc.section.3"><link rel="Chapter" title="4 Complex Profiles" href="#rfc.section.4"><link rel="Chapter" title="5 GSS-API Profile and Subset Identifiers" href="#rfc.section.5"><link rel="Chapter" title="6 Mechanism Profiles" href="#rfc.section.6"><link rel="Chapter" title="7 Minimized GSS-API Implementations" href="#rfc.section.7"><link rel="Chapter" title="8 IANA Considerations" href="#rfc.section.8"><link rel="Chapter" title="9 Security Considerations" href="#rfc.section.9"><link rel="Chapter" href="#rfc.section.10" title="10 Informative References"><meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.580, 2012-06-03 11:18:18, XSLT vendor: SAXON 9.0.0.4 from Saxonica http://www.saxonica.com/"><meta name="keywords" content="Internet-Draft"><link rel="schema.dct" href="http://purl.org/dc/terms/"><meta name="dct.creator" content="Williams, N."><meta name="dct.identifier" content="urn:ietf:id:draft-williams-gss-profiles-00"><meta name="dct.issued" scheme="ISO8601" content="2012-12-14"><meta name="dct.abstract" content="The Generic Security Service Application Programming Interface (GSS-API) is often mistaken for a bloated framework. The GSS-API is really several things: a basis for formal descriptions of application authentication protocols (what happens when), a pattern for actual programming APIs, a set of constraints and requirements for generic security mechanisms, and concrete programming APIs. Only the first of these is relevant to Internet application protocols. This document describes simplified and minimized profiles of the GSS-API for two purposes: explaining its use, whether in standards specifications or actual applications, and specifying sub-sets of the API for a) newcomers to the API, b) application developers that wish to use it but not have to link the whole thing into their applications."><meta name="description" content="The Generic Security Service Application Programming Interface (GSS-API) is often mistaken for a bloated framework. The GSS-API is really several things: a basis for formal descriptions of application authentication protocols (what happens when), a pattern for actual programming APIs, a set of constraints and requirements for generic security mechanisms, and concrete programming APIs. Only the first of these is relevant to Internet application protocols. This document describes simplified and minimized profiles of the GSS-API for two purposes: explaining its use, whether in standards specifications or actual applications, and specifying sub-sets of the API for a) newcomers to the API, b) application developers that wish to use it but not have to link the whole thing into their applications."></head><body><table class="header"><tbody><tr><td class="left">Network Working Group</td><td class="right">N. Williams</td></tr><tr><td class="left">Internet-Draft</td><td class="right">Cryptonector</td></tr><tr><td class="left">Intended status: Informational</td><td class="right">December 14, 2012</td></tr><tr><td class="left">Expires: June 17, 2013</td><td class="right"></td></tr></tbody></table><p class="title">Simplified and Minimized Profiles of the Generic Security Services Application Programming Interface<br><span class="filename">draft-williams-gss-profiles-00</span></p><h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1><p>The Generic Security Service Application Programming Interface (GSS-API) is often mistaken for a bloated framework. The GSS-API is really several things: a basis for formal descriptions of application authentication protocols (what happens when), a pattern for actual programming APIs, a set of constraints and requirements for generic security mechanisms, and concrete programming APIs. Only the first of these is relevant to Internet application protocols.</p><p>This document describes simplified and minimized profiles of the GSS-API for two purposes: explaining its use, whether in standards specifications or actual applications, and specifying sub-sets of the API for a) newcomers to the API, b) application developers that wish to use it but not have to link the whole thing into their applications.</p><h1><a id="rfc.status" href="#rfc.status">Status of this Memo</a></h1><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as &#8220;work in progress&#8221;.</p><p>This Internet-Draft will expire on June 17, 2013.</p><h1><a id="rfc.copyrightnotice" href="#rfc.copyrightnotice">Copyright Notice</a></h1><p>Copyright © 2012 IETF Trust and the persons identified as the document authors. All rights reserved.</p><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p><hr class="noprint"><h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1><ul class="toc"><li>1.&nbsp;&nbsp;&nbsp;<a href="#d1e295">Introduction</a><ul><li>1.1&nbsp;&nbsp;&nbsp;<a href="#d1e329">A Brief Primer on the GSS-API</a></li><li>1.2&nbsp;&nbsp;&nbsp;<a href="#d1e405">Conventions used in this document</a></li></ul></li><li>2.&nbsp;&nbsp;&nbsp;<a href="#d1e420">Simple Profiles of the GSS-API</a><ul><li>2.1&nbsp;&nbsp;&nbsp;<a href="#sub_Trivial_Initiator">Trivial Initiator (client) Application</a></li><li>2.2&nbsp;&nbsp;&nbsp;<a href="#sub_Simple_Initiator">Simple Initiator Application</a></li><li>2.3&nbsp;&nbsp;&nbsp;<a href="#sub_Trivial_Acceptor">Trivial Acceptor (server) Application</a></li><li>2.4&nbsp;&nbsp;&nbsp;<a href="#sub_Simple_Acceptor">Simple Acceptor Application</a></li></ul></li><li>3.&nbsp;&nbsp;&nbsp;<a href="#sec_Transport_Security_Layer">Transport Security Layer Profiles</a><ul><li>3.1&nbsp;&nbsp;&nbsp;<a href="#sub_Null_Transport_Security">Null Transport Security</a></li><li>3.2&nbsp;&nbsp;&nbsp;<a href="#sub_TLS_Name_Binding">TLS with Server Name Binding</a></li><li>3.3&nbsp;&nbsp;&nbsp;<a href="#sub_TLS_CB">TLS with Channel Binding</a></li><li>3.4&nbsp;&nbsp;&nbsp;<a href="#sub_Per_msg_tokens">Per-Message Tokens</a></li><li>3.5&nbsp;&nbsp;&nbsp;<a href="#sub_PRF">GSS-Keyed Application Transport Security Layer</a></li></ul></li><li>4.&nbsp;&nbsp;&nbsp;<a href="#d1e765">Complex Profiles</a><ul><li>4.1&nbsp;&nbsp;&nbsp;<a href="#sub_Complex_Initiator_Application">Advanced Initiator Application</a></li><li>4.2&nbsp;&nbsp;&nbsp;<a href="#sub_Complex_Acceptor_Application">Advanced Acceptor Application</a></li></ul></li><li>5.&nbsp;&nbsp;&nbsp;<a href="#sec_identifiers">GSS-API Profile and Subset Identifiers</a><ul><li>5.1&nbsp;&nbsp;&nbsp;<a href="#d1e995">C-Bindings</a></li></ul></li><li>6.&nbsp;&nbsp;&nbsp;<a href="#d1e1005">Mechanism Profiles</a><ul><li>6.1&nbsp;&nbsp;&nbsp;<a href="#d1e1014">Intranet Profile: SPNEGO, Kerberos</a></li><li>6.2&nbsp;&nbsp;&nbsp;<a href="#d1e1023">Internet Profile: SPNEGO, &lt;TBD&gt;</a></li></ul></li><li>7.&nbsp;&nbsp;&nbsp;<a href="#d1e1032">Minimized GSS-API Implementations</a></li><li>8.&nbsp;&nbsp;&nbsp;<a href="#d1e1057">IANA Considerations</a></li><li>9.&nbsp;&nbsp;&nbsp;<a href="#d1e1069">Security Considerations</a></li><li>10.&nbsp;&nbsp;&nbsp;<a href="#rfc.references">Informative References</a></li><li><a href="#rfc.authors">Author's Address</a></li></ul><hr class="noprint"><h1 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a id="d1e295" href="#d1e295">Introduction</a></h1><p id="rfc.section.1.p.1">There has been some confusion in the Internet community as to the nature of the GSS-API. One problem that has been identified by some is that the GSS-API is quite large, that simpler subsets of it may be desirable. This document proposes some subsets and &#8220;profiles&#8221; of the GSS-API. We hope this will make the API more approachable, acceptable, and easier to understand.</p><p id="rfc.section.1.p.2">The GSS-API is first and foremost an <em>abstract</em> API whose purpose is to describe with high precision how Internet application protocols handle user/service authentication and transport security.</p><p id="rfc.section.1.p.3">The GSS-API is also a set of constraints on its security mechanisms.</p><p id="rfc.section.1.p.4">The GSS-API is also a pattern for programming language bindings of the abstract GSS-API. In the IETF we have standardized C and Java bindings for the abstract API.</p><p id="rfc.section.1.p.5">Note that there is <em>absolutely no requirement</em> that implementators use the C or Java, or any other bindings of the GSS-API to implement applications whose specifications use the <em>abstract</em> GSS-API. For example, one major implementor uses a different API (though in broad strokes quite similar to the GSS-API) to access generic security mechanisms, and applications using that API interoperate perfectly with applications that use bonafide GSS-API implementations.</p><p id="rfc.section.1.p.6">By providing minimized profiles/subsets of the GSS-API we hope to make the GSS-API easier to use.</p><h2 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a>&nbsp;<a id="d1e329" href="#d1e329">A Brief Primer on the GSS-API</a></h2><p id="rfc.section.1.1.p.1">In GSS terminology we have:</p><p id="rfc.section.1.1.p.2"> </p><dl><dt>Principals</dt><dd>Entities to be authenticated;</dd><dt>Credentials</dt><dd>Credentials are used to authenticate principals;</dd><dt>Security&nbsp;context&nbsp;tokens</dt><dd>Messages exchanged by two principals to authenticate one to the other (and possibly the other to the one);</dd><dt>Security&nbsp;contexts</dt><dd>The shared state (e.g., session keys) that results from a successful exchange of security context tokens;</dd><dt>Initiator</dt><dd>The party (typically the client) that initiates a security context token exchange;</dd><dt>Acceptor</dt><dd>The party (typically the server) that receives an initial security context token.</dd></dl><p id="rfc.section.1.1.p.3">The abstract API has a few data types:</p><p id="rfc.section.1.1.p.4"> </p><dl><dt>Buffers</dt><dd>Octet strings;</dd><dt>OIDs</dt><dd>Constants identifying GSS mechanisms and name types;</dd><dt>OID&nbsp;sets</dt><dd>Sets of OIDs;</dd><dt>NAME</dt><dd>Opaque object representing the name of a principal;</dd><dt>CREDENTIAL&nbsp;HANDLE</dt><dd>Opaque object representing a credential for authenticating the entity that has access to it;</dd><dt>SECURITY&nbsp;CONTEXT&nbsp;HANDLE</dt><dd>Opaque object representing a security context.</dd></dl><h2 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2</a>&nbsp;<a id="d1e405" href="#d1e405">Conventions used in this document</a></h2><p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.</p><hr class="noprint"><h1 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a id="d1e420" href="#d1e420">Simple Profiles of the GSS-API</a></h1><p id="rfc.section.2.p.1">We define profiles of the GSS-API for a variety of applications. These can be used both, for application security protocol specifications, and for implementation (but the latter is never required).</p><p id="rfc.section.2.p.2"> </p><ul><li>Trivial client (&#8220;initiator&#8221;) applications;</li><li>Simple initiator applications;</li><li>Various security layer options;</li><li>Trivial server (&#8220;acceptor&#8221;) applications;</li><li>Simple acceptor applications.</li></ul><p id="rfc.section.2.p.3">We also define C bindings for these profiles, as well as for specific additional subsets of GSS-API functionality. These will take the form of C pre-processor macros indicating what profiles and functionality subsets are available.</p><h2 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1</a>&nbsp;<a id="sub_Trivial_Initiator" href="#sub_Trivial_Initiator">Trivial Initiator (client) Application</a></h2><p id="rfc.section.2.1.p.1">This profile requires just six GSS-API functions, three of which are destructors, and one of which is a function for formatting error strings:</p><p id="rfc.section.2.1.p.2"> </p><dl><dt>GSS_Import_name()</dt><dd>Produces a NAME object given a string and a name type;</dd><dt>GSS_Init_sec_context()</dt><dd>Drives the exchange of security context tokens (authentication messages) on the initiator side;</dd><dt>GSS_Display_status()</dt><dd>Produces a human-readable representation of a status code (error code);</dd></dl><p id="rfc.section.2.1.p.3">destructor functions:</p><p id="rfc.section.2.1.p.4"> </p><ul><li>GSS_Release_name()</li><li>GSS_Release_buffer()</li><li>GSS_Delete_sec_context()</li></ul><p id="rfc.section.2.1.p.5">The trivial initiator application profile REQUIRES two name-types: GSS_C_NT_HOSTBASED_SERVICE and GSS_C_NO_OID (denoting a mechanism-specific default name syntax).</p><p id="rfc.section.2.1.p.6">A trivial initiator application begins by using GSS_Import_name() to get a NAME object for the target acceptor (server). This will be a host-based service name like &#8220;HTTP@hostname&#8221;. The application then loops over GSS_Init_sec_context() to drive the exchange security context tokens (authentication messages) with the target.</p><p id="rfc.section.2.1.p.7">Most input arguments to GSS_Init_sec_context() will be defaulted.</p><p id="rfc.section.2.1.p.8">If a trivial initiator application has multiple initiator credentials to choose from then the choice of credential will be left to the GSS-API framework or security mechanism. GSS-API implementations SHOULD provide some facility for configuring reasonable initiator identity selection.</p><h2 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2</a>&nbsp;<a id="sub_Simple_Initiator" href="#sub_Simple_Initiator">Simple Initiator Application</a></h2><p id="rfc.section.2.2.p.1">This profile adds two functions to the trivial initiator application profile, one of which is a destructor:</p><p id="rfc.section.2.2.p.2"> </p><dl><dt>GSS_Acquire_cred()</dt><dd>Produces a CREDENTIAL HANDLE for a given desired NAME.</dd></dl><p id="rfc.section.2.2.p.3">destructor function:</p><p id="rfc.section.2.2.p.4"> </p><ul><li>GSS_Release_cred()</li></ul><p id="rfc.section.2.2.p.5">The initiator application may have multiple credentials and want to choose a specific one to authenticate as to a target. Such an application does so by calling GSS_Import_name() for the desired name, then GSS_Acquire_cred() to acquire a CREDENTIAL HANDLE to pass to GSS_Init_sec_context() as the initiator credential.</p><h2 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3</a>&nbsp;<a id="sub_Trivial_Acceptor" href="#sub_Trivial_Acceptor">Trivial Acceptor (server) Application</a></h2><p id="rfc.section.2.3.p.1">This profile requires just eight GSS-API functions, three of which are destructors, and one of which is a function for formatting error strings:</p><p id="rfc.section.2.3.p.2"> </p><dl><dt>GSS_Accept_sec_context()</dt><dd>Driver of security context token exchange;</dd><dt>GSS_Display_name_ext()</dt><dd>Produces human-readable representation of a NAME object in the syntax of selected name type, if possible;</dd><dt>GSS_Display_name()</dt><dd>Produces a human-readable representation of a NAME object in a mechanism-specific syntax;</dd><dt>GSS_Export_name()</dt><dd>Produces a machine-readable representation of a NAME object in a mechanism-specific format;</dd><dt>GSS_Display_status()</dt><dd>Produces a human-readable representation of a status code (error code);</dd></dl><p id="rfc.section.2.3.p.3">destructor functions:</p><p id="rfc.section.2.3.p.4"> </p><ul><li>GSS_Release_name()</li><li>GSS_Release_buffer()</li><li>GSS_Delete_sec_context()</li></ul><p id="rfc.section.2.3.p.5">This profile REQUIRES one name-type: GSS_C_NT_USERNAME.</p><p id="rfc.section.2.3.p.6">A trivial acceptor application begins by using GSS_Accept_sec_context() to drive an exchange of security context tokens by which to authenticate an initiator. A successful authentication will yield a NAME representing the identity of the initiator &#8211; the acceptor will perform authorization based on the name of the initiator. The acceptor application MUST use one of GSS_Display_name_ext(), GSS_Display_name(), or GSS_Export_name() to obtain a textual or binary representation of the initiator name suitable for authorization.</p><p id="rfc.section.2.3.p.7">Most input arguments to GSS_Accept_sec_context() will be defaulted.</p><p id="rfc.section.2.3.p.8">If a trivial acceptor application has multiple acceptor credentials to choose from then the choice will be the initiator's.</p><h2 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4</a>&nbsp;<a id="sub_Simple_Acceptor" href="#sub_Simple_Acceptor">Simple Acceptor Application</a></h2><p id="rfc.section.2.4.p.1">This profile adds three functions to the trivial initiator application profile:</p><p id="rfc.section.2.4.p.2"> </p><dl><dt>GSS_Inquire_context()</dt><dd>A simple acceptor application may be interested in knowing what name it was called by the initiator, and may do so by calling GSS_Inquire_context().</dd><dt>GSS_Store_cred()</dt><dd>A simple acceptor application may have a use for delegated credentials. This function makes it possible to make delegated credentials available to other applications.</dd><dt>GSS_Release_cred()</dt><dd>This is the destructor for the delegated CREDENTIAL HANDLE.</dd></dl><hr class="noprint"><h1 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a id="sec_Transport_Security_Layer" href="#sec_Transport_Security_Layer">Transport Security Layer Profiles</a></h1><p id="rfc.section.3.p.1">Internet applications often require transport security &#8211; integrity protection or integrity and confidentiality protection. In simpler terms: some applications require encryption.</p><p id="rfc.section.3.p.2">The GSS-API was originally designed to provide facilities that the application could use to protect its in-flight data. Since then a number of options have been added to make it easier to use the GSS-API in existing applications that already have transport security facilities. The GSS-API now supports applications that use TLS for transport security, applications that have their own cryptographic transport protection facilities (like AFS' RX transport), as well as applications that can just use the original GSS-API transport security facilities.</p><p id="rfc.section.3.p.3">It is now possible to retrofit the GSS-API for authentication (and, where required, key exchange) into the widest possible range of applications.</p><h2 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1</a>&nbsp;<a id="sub_Null_Transport_Security" href="#sub_Null_Transport_Security">Null Transport Security</a></h2><p id="rfc.section.3.1.p.1">In some environments strong authentication of users and services is sufficient, with no need to protect in-flight data from passive nor active attacks. The trivial and simple profiles of the GSS-API suffice for these applications.</p><h2 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2</a>&nbsp;<a id="sub_TLS_Name_Binding" href="#sub_TLS_Name_Binding">TLS with Server Name Binding</a></h2><p id="rfc.section.3.2.p.1">This profile adds not functions to any of the trivial and simple acceptor application profiles.</p><p id="rfc.section.3.2.p.2">Applications using this profile use TLS <a href="#RFC5246"><cite title="The Transport Layer Security (TLS) Protocol Version 1.2">[RFC5246]</cite></a> for transport security and the GSS-API for authentication. This profile REQUIRES that applications use the 'tls-server-end-point' channel binding type <a href="#RFC5929"><cite title="Channel Bindings for TLS">[RFC5929]</cite></a> a TLS server certificate to authenticate the server to the client and that the same server name used to authenticate the server in TLS also be used to authenticate the server in the GSS-API.</p><h2 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3</a>&nbsp;<a id="sub_TLS_CB" href="#sub_TLS_CB">TLS with Channel Binding</a></h2><p id="rfc.section.3.3.p.1">This profile adds no functions to any of the initiator or acceptor application profiles. Instead this profile makes support for channel binding <a href="#RFC5056"><cite title="On the Use of Channel Bindings to Secure Channels">[RFC5056]</cite></a> REQUIRED.</p><p id="rfc.section.3.3.p.2">Applications using this profile use TLS <a href="#RFC5246"><cite title="The Transport Layer Security (TLS) Protocol Version 1.2">[RFC5246]</cite></a> for transport security, possibly using anonymous Diffie-Hellman (DH) cipher suites. Channel binding ensures that the end-points of the TLS connection are logically the same as the GSS-API end-points, thus ensuring that there are no men in the middle (MITMs) even if anonymous DH TLS cipher suites are used.</p><h2 id="rfc.section.3.4"><a href="#rfc.section.3.4">3.4</a>&nbsp;<a id="sub_Per_msg_tokens" href="#sub_Per_msg_tokens">Per-Message Tokens</a></h2><p id="rfc.section.3.4.p.1">This profile adds four functions to the simple initiator application profile:</p><p id="rfc.section.3.4.p.2"> </p><dl><dt>GSS_GetMIC()</dt><dd>Get an authentication code for a message (something like a MAC);</dd><dt>GSS_VerifyMIC()</dt><dd>Verify an authentication code sent by the peer;</dd><dt>GSS_Wrap()</dt><dd>Wrap an application message, typically to provide confidentiality and integrity protection (i.e., encrypt with authentication);</dd><dt>GSS_Unwrap()</dt><dd>Unwrap a wrapped application message (i.e., decrypt with authentication).</dd></dl><p id="rfc.section.3.4.p.3">An application of this type will rely on the GSS-API security mechanism to provide confidentiality and/or integrity protection to the application's messages. This kind of application typically does not use TLS or any other framework for transport security.</p><p id="rfc.section.3.4.p.4">Applications may use these functions to implement either of octet streams and unsequenced datagram security layers.</p><h2 id="rfc.section.3.5"><a href="#rfc.section.3.5">3.5</a>&nbsp;<a id="sub_PRF" href="#sub_PRF">GSS-Keyed Application Transport Security Layer</a></h2><p id="rfc.section.3.5.p.1">This profile adds one function to the simple initiator application profile:</p><p id="rfc.section.3.5.p.2"> </p><dl><dt>GSS_Pseudo_random()</dt><dd>Get a pseudo-random output octet string based on session keys exchanged by the GSS-API security mechanism and an input octet string provided by the application.</dd></dl><p id="rfc.section.3.5.p.3">An application of this type typically has its own transport security layer (i.e., does its own encryption) and only requires a session key, which it can get from the GSS-API security context by using the GSS_Pseudo_random() <a href="#RFC4401"><cite title="A Pseudo-Random Function (PRF) API Extension for the Generic Security Service Application Program Interface (GSS-API)">[RFC4401]</cite></a> function to obtain an octet string of suitable length.</p><hr class="noprint"><h1 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a id="d1e765" href="#d1e765">Complex Profiles</a></h1><h2 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1</a>&nbsp;<a id="sub_Complex_Initiator_Application" href="#sub_Complex_Initiator_Application">Advanced Initiator Application</a></h2><p id="rfc.section.4.1.p.1">A complex initiator application requires most of the functions defined in <a href="#RFC5587"><cite title="Extended Generic Security Service Mechanism Inquiry APIs">[RFC5587]</cite></a> in addition to those of the simple initiator application profile:</p><p id="rfc.section.4.1.p.2"> </p><dl><dt>GSS_Indicate_mechs_by_attrs()</dt><dd>Select mechanisms based on desired attributes;</dd><dt>GSS_Inquire_attrs_for_mech()</dt><dd>Get the set of attributes of a given mechanism.</dd></dl><p id="rfc.section.4.1.p.3">These functions are useful for mechanism negotiation.</p><h2 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2</a>&nbsp;<a id="sub_Complex_Acceptor_Application" href="#sub_Complex_Acceptor_Application">Advanced Acceptor Application</a></h2><p id="rfc.section.4.2.p.1">A complex acceptor application typically requires fine-grained access to the initiator names so as to implement more advanced authorization schemes. This means all of the naming extensions APIs:</p><p id="rfc.section.4.2.p.2"> </p><dl><dt>GSS_Display_name_ext()</dt><dd>Already covered in <a href="#sub_Trivial_Acceptor" title="Trivial Acceptor (server) Application">Section&nbsp;2.3</a>.</dd><dt>GSS_Inquire_name()</dt><dd>Needed to list attributes available in the initiator name.</dd><dt>GSS_Get_name_attribute()</dt><dd>Needed to access individual attributes of the initiator name.</dd><dt>GSS_Export_name_composite()</dt><dd>Needed to be able to save a binary version of the initiator name with all its attributes.</dd></dl><p id="rfc.section.4.2.p.3">Complex acceptor applications may also need at least one extended mechanism inquiry function <a href="#RFC5587"><cite title="Extended Generic Security Service Mechanism Inquiry APIs">[RFC5587]</cite></a>:</p><p id="rfc.section.4.2.p.4"> </p><dl><dt>GSS_Inquire_attrs_for_mech()</dt><dd>Get the set of attributes of a given mechanism.</dd></dl><hr class="noprint"><h1 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a id="sec_identifiers" href="#sec_identifiers">GSS-API Profile and Subset Identifiers</a></h1><p id="rfc.section.5.p.1">We define identifiers for GSS-API profiles and subsets. These should be used as follows:</p><p id="rfc.section.5.p.2"> </p><ul><li>Internet application specifications using the GSS-API must list the profiles/subsets of the API required to implement the specification;</li><li>GSS-API implementations SHOULD use these identifiers to advertise which profiles/subsets of the API are available</li><li>GSS-API application implementations using the GSS-API in the implementation SHOULD use these identifiers to request profiles/subsets of the API to use.</li></ul><p id="rfc.section.5.p.3">The identifiers are:</p><p id="rfc.section.5.p.4"> </p><dl><dt>GSS_PR_V2U1</dt><dd>This refers to the base GSS-API version 2 update 1.</dd><dt>GSS_PR_TRIVIAL_INITIATOR</dt><dd>See <a href="#sub_Trivial_Initiator" title="Trivial Initiator (client) Application">Section&nbsp;2.1</a>.</dd><dt>GSS_PR_SIMPLE_INITIATOR</dt><dd>See <a href="#sub_Simple_Initiator" title="Simple Initiator Application">Section&nbsp;2.2</a>.</dd><dt>GSS_PR_TRIVIAL_ACCEPTOR</dt><dd>See <a href="#sub_Trivial_Acceptor" title="Trivial Acceptor (server) Application">Section&nbsp;2.3</a>.</dd><dt>GSS_PR_SIMPLE_ACCEPTOR</dt><dd>See <a href="#sub_Simple_Acceptor" title="Simple Acceptor Application">Section&nbsp;2.4</a>.</dd><dt>GSS_PR_ADVANCED_INITIATOR</dt><dd>See <a href="#sub_Complex_Initiator_Application" title="Advanced Initiator Application">Section&nbsp;4.1</a>.</dd><dt>GSS_PR_ADVANCED_ACCEPTOR</dt><dd>See <a href="#sub_Complex_Acceptor_Application" title="Advanced Acceptor Application">Section&nbsp;4.2</a>.</dd><dt>GSS_PR_CB</dt><dd>See <a href="#sub_TLS_CB" title="TLS with Channel Binding">Section&nbsp;3.3</a>.</dd><dt>GSS_PR_MSG_TOKENS</dt><dd>See <a href="#sub_Per_msg_tokens" title="Per-Message Tokens">Section&nbsp;3.4</a>.</dd><dt>GSS_PR_PRF</dt><dd>See <a href="#sub_PRF" title="GSS-Keyed Application Transport Security Layer">Section&nbsp;3.5</a>  <a href="#RFC4401"><cite title="A Pseudo-Random Function (PRF) API Extension for the Generic Security Service Application Program Interface (GSS-API)">[RFC4401]</cite></a>.</dd><dt>GSS_PR_STORE_CRED</dt><dd>See <a href="#sub_Simple_Acceptor" title="Simple Acceptor Application">Section&nbsp;2.4</a> and <a href="#RFC5588"><cite title="Generic Security Service Application Program Interface (GSS-API) Extension for Storing Delegated Credentials">[RFC5588]</cite></a> </dd><dt>GSS_PR_EXTENDED_MECH_INQUIRY</dt><dd>Functions from <a href="#RFC5587"><cite title="Extended Generic Security Service Mechanism Inquiry APIs">[RFC5587]</cite></a> </dd><dt>GSS_PR_EXTENDED_NAMING</dt><dd>Functions from <a href="#RFC6680"><cite title="Generic Security Service Application Programming Interface (GSS-API) Naming Extensions">[RFC6680]</cite></a> </dd></dl><h2 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1</a>&nbsp;<a id="d1e995" href="#d1e995">C-Bindings</a></h2><p id="rfc.section.5.1.p.1">C pre-processor macros MUST be defined by &lt;gssapi.h&gt; or &lt;gssapi/gssapi.h&gt; for each of the supported profiles and subsets of the GSS-API supported by the GSS-API implementation. The C pre-processor macro names MUST be as given in the preceding section, and the value should be 1 if the macro is defined.</p><hr class="noprint"><h1 id="rfc.section.6" class="np"><a href="#rfc.section.6">6.</a>&nbsp;<a id="d1e1005" href="#d1e1005">Mechanism Profiles</a></h1><p id="rfc.section.6.p.1">A mechanism profile is a set of GSS-API mechanisms that MUST be provided.</p><h2 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1</a>&nbsp;<a id="d1e1014" href="#d1e1014">Intranet Profile: SPNEGO, Kerberos</a></h2><p id="rfc.section.6.1.p.1">...</p><h2 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2</a>&nbsp;<a id="d1e1023" href="#d1e1023">Internet Profile: SPNEGO, &lt;TBD&gt;</a></h2><p id="rfc.section.6.2.p.1">...</p><hr class="noprint"><h1 id="rfc.section.7" class="np"><a href="#rfc.section.7">7.</a>&nbsp;<a id="d1e1032" href="#d1e1032">Minimized GSS-API Implementations</a></h1><p id="rfc.section.7.p.1">Typically a GSS-API implementation includes all of the basic version 2, update 1 API <a href="#RFC2743"><cite title="Generic Security Service Application Program Interface Version 2, Update 1">[RFC2743]</cite></a>. For embedded and mobile applications it may be desirable to have minimized GSS-API implementations, both for the framework itself and the mechanisms. A minimized implementation should provide at least the functionality required by the application and, preferably, no more than is required by the application. In practice this may mean that a complete implementation may have to provide tools for reducing the functionality provided.</p><p id="rfc.section.7.p.2">One possibility may be to implement a system whereby all the sources for a C implementation are combined into a single file and then C pre-processing can be used to eliminate all functionality that is not desired, then the resulting object file is linked into the application. This is known by some as an &#8220;amalgamation&#8221;, and is much like static linking, but can be significantly more selective. This approach is used by SQLite3, for example.</p><p id="rfc.section.7.p.3">Another possibility is to structure the framework library and the mechanism plugins such that subsets are in distinct static linking archives or shared objects. This approach may result in a multiplicity of libraries and/or packages that reflect the profiles of the GSS-API.</p><p id="rfc.section.7.p.4">For minimization we recommend either the amalgamation approach or a scheme whereby static linking archives are used. For general purpose use we recommend dynamic linking and no minimization.</p><hr class="noprint"><h1 id="rfc.section.8" class="np"><a href="#rfc.section.8">8.</a>&nbsp;<a id="d1e1057" href="#d1e1057">IANA Considerations</a></h1><p id="rfc.section.8.p.1">We ask the IANA to create a registry of GSS-API profiles and subsets, with the identifiers list from of <a href="#sec_identifiers" title="GSS-API Profile and Subset Identifiers">Section&nbsp;5</a> as its contents.</p><hr class="noprint"><h1 id="rfc.section.9" class="np"><a href="#rfc.section.9">9.</a>&nbsp;<a id="d1e1069" href="#d1e1069">Security Considerations</a></h1><p id="rfc.section.9.p.1">The security considerations of the GSS-API version 2, update 1, and its various extensions apply. Using too trivial a profile for an application can have security impact. For example, applications using the trivial initiator application profile (GSS_PR_TRIVIAL_INITIATOR) cannot select an initiator identity and depend entirely on the framework and/or selected mechanism for this.</p><p id="rfc.section.9.p.2">Internet applications that use GSS mechanisms should specify one of th transport security layers from <a href="#sec_Transport_Security_Layer" title="Transport Security Layer Profiles">Section&nbsp;3</a> other than the null layer as required to implement. The simplest transport security layer is, of course, none at all (see <a href="#sub_Null_Transport_Security" title="Null Transport Security">Section&nbsp;3.1</a>), but this is not secure in the Internet threat model; all the other options listed in <a href="#sec_Transport_Security_Layer" title="Transport Security Layer Profiles">Section&nbsp;3</a> offer good security in the Internet threat model. The next simplest may well be to use TLS with server name binding (see <a href="#sub_TLS_Name_Binding" title="TLS with Server Name Binding">Section&nbsp;3.2</a>).</p><h1 class="np" id="rfc.references"><a href="#rfc.section.10" id="rfc.section.10">10.</a> Informative References</h1><table><tr><td class="reference"><b id="RFC2119">[RFC2119]</b></td><td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, &#8220;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>&#8221;, BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr><tr><td class="reference"><b id="RFC5246">[RFC5246]</b></td><td class="top">Dierks, T. and E. Rescorla, &#8220;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>&#8221;, RFC&nbsp;5246, August&nbsp;2008.</td></tr><tr><td class="reference"><b id="RFC5056">[RFC5056]</b></td><td class="top">Williams, N., &#8220;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>&#8221;, RFC&nbsp;5056, November&nbsp;2007.</td></tr><tr><td class="reference"><b id="RFC5929">[RFC5929]</b></td><td class="top">Altman, J., Williams, N., and L. Zhu, &#8220;<a href="http://tools.ietf.org/html/rfc5929">Channel Bindings for TLS</a>&#8221;, RFC&nbsp;5929, July&nbsp;2010.</td></tr><tr><td class="reference"><b id="RFC2743">[RFC2743]</b></td><td class="top"><a href="mailto:jlinn@rsasecurity.com" title="RSA Laboratories">Linn, J.</a>, &#8220;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>&#8221;, RFC&nbsp;2743, January&nbsp;2000.</td></tr><tr><td class="reference"><b id="RFC5587">[RFC5587]</b></td><td class="top">Williams, N., &#8220;<a href="http://tools.ietf.org/html/rfc5587">Extended Generic Security Service Mechanism Inquiry APIs</a>&#8221;, RFC&nbsp;5587, July&nbsp;2009.</td></tr><tr><td class="reference"><b id="RFC6680">[RFC6680]</b></td><td class="top">Williams, N., Johansson, L., Hartman, S., and S. Josefsson, &#8220;<a href="http://tools.ietf.org/html/rfc6680">Generic Security Service Application Programming Interface (GSS-API) Naming Extensions</a>&#8221;, RFC&nbsp;6680, August&nbsp;2012.</td></tr><tr><td class="reference"><b id="RFC5588">[RFC5588]</b></td><td class="top">Williams, N., &#8220;<a href="http://tools.ietf.org/html/rfc5588">Generic Security Service Application Program Interface (GSS-API) Extension for Storing Delegated Credentials</a>&#8221;, RFC&nbsp;5588, July&nbsp;2009.</td></tr><tr><td class="reference"><b id="RFC4401">[RFC4401]</b></td><td class="top">Williams, N., &#8220;<a href="http://tools.ietf.org/html/rfc4401">A Pseudo-Random Function (PRF) API Extension for the Generic Security Service Application Program Interface (GSS-API)</a>&#8221;, RFC&nbsp;4401, February&nbsp;2006.</td></tr></table><hr class="noprint"><div class="avoidbreak"><h1 id="rfc.authors" class="np"><a href="#rfc.authors">Author's Address</a></h1><address class="vcard"><span class="vcardline"><span class="fn">Nicolas Williams</span><span class="n hidden"><span class="family-name">Williams</span><span class="given-name">Nicolas</span></span></span><span class="org vcardline">Cryptonector, LLC</span><span class="vcardline">EMail: <a href="mailto:nico@cryptonector.com"><span class="email">nico@cryptonector.com</span></a></span></address></div></body></html>